# Load zgen.
source "${HOME}/.zgen/zgen.zsh"

# If the init script doesn't exist.
if ! zgen saved; then
  # Specify plugins and themes here.
  zgen load romkatv/powerlevel10k powerlevel10k 
  zgen load zsh-users/zsh-autosuggestions
  zgen load zsh-users/zsh-syntax-highlighting
  zgen load zsh-users/zsh-history-substring-search

  # Generate the init script from plugins above
  zgen save
fi

# If you come from bash you might have to change your $PATH.
export PATH=$HOME/bin:/usr/local/bin:$PATH

# Set name of the theme to load --- if set to "random", it will
# load a random theme each time oh-my-zsh is loaded, in which case,
# to know which specific one was loaded, run: echo $RANDOM_THEME
# See https://github.com/ohmyzsh/ohmyzsh/wiki/Themes
ZSH_THEME="powerlevel10k/powerlevel10k"

# Uncomment the following line to use hyphen-insensitive completion.
# Case-sensitive completion must be off. _ and - will be interchangeable.
HYPHEN_INSENSITIVE="true"

# Uncomment the following line to display red dots whilst waiting for completion.
# You can also set it to another string to have that shown instead of the default red dots.
# e.g. COMPLETION_WAITING_DOTS="%F{yellow}waiting...%f"
# Caution: this setting can cause issues with multiline prompts in zsh < 5.7.1 (see #5765)
COMPLETION_WAITING_DOTS="true"

# Which plugins would you like to load?
# Standard plugins can be found in $ZSH/plugins/
# Custom plugins may be added to $ZSH_CUSTOM/plugins/
# Example format: plugins=(rails git textmate ruby lighthouse)
# Add wisely, as too many plugins slow down shell startup.
plugins=(
	zsh-autosuggestions # Suggestions from partial input. Like fish shell.
	zsh-syntax-highlighting
	zsh-history-substring-search
)

# This behaviour seems to exist out-of-the-box elsewhere, but not on
# M1 MacBook Pros.
# https://github.com/zsh-users/zsh-history-substring-search#usage
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

# This is required to stop "Alt + Left" and "Alt + Right" from misbehaving
# in a chezmoi-started shell.
# Seems to only happen on an M1 MacBook Pro with Alacritty 0.10.1 and Montery 12.2.1.
bindkey "^[b" backward-word
bindkey "^[f" forward-word

# User configuration

# export MANPATH="/usr/local/man:$MANPATH"

# Preferred editor for local and remote sessions
export EDITOR='nvim'

alias g="git"
alias cz="chezmoi"
alias vim="nvim"
alias less="bat"

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

# Load fzf config.
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# Handy alias from @jdavidson for automating the fixup and rebase workflow.
# Requires autostash=true.
function gitfixr() { 
	git commit --fixup=$1 && git rebase -i --autosquash $1^
}
alias fixr="gitfixr"
